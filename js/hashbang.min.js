'use strict';((c)=>{const h=c.document,m=c.location;Object.defineProperty(Object.prototype,"define",{value:function(a,b,d){const c="configurable enumerable value writable get set".split(" ");if(null===b||Object.keys(b).every((a)=>!c.includes(a)))b={value:b,writable:d||!1,enumerable:!a.startsWith("_")};Object.defineProperty(this,a,b)}});const f={$:{value:function(a){return this.querySelector(a)}},$$:{value:function(a){return[...this.querySelectorAll(a)]}},addAttribute:{value:function(a){this.setAttribute(a,
"")}},clearChildren:{value:function(){let a;for(;null!==(a=this.firstChild);)this.removeChild(a)}},findParentElement:{value:function(a){let b=this;for(;null!==b&&b!==h.documentElement;){if(b===a)return!0;b=b.parentElement}return!1}}};Object.defineProperties(Element.prototype,f);Object.defineProperties(Document.prototype,f);Object.defineProperties(DocumentFragment.prototype,f);Object.defineProperties(Array.prototype,{clear:{value:function(){for(;this.length;)this.shift()}},select:{value:function(a){return this.reduce((b,
d)=>b.concat(a(d)),[])}}});void 0===Math.clamp&&Math.define("clamp",(a,b,d)=>Math.min(Math.max(+a,+b),+d));class k{constructor(a,b){this.define("type",a);this.define("callback",b)}}class e{constructor(){this.define("_events",[])}dispatch(a,...b){this._events.forEach((d)=>{d.type===a&&d.callback(...b)})}on(a,b){this._events.push(new k(a,b))}}class n extends e{constructor(){super();this.define("_id",null,!0)}start(a){this.stop();this.dispatch("started");this._id=c.setTimeout(()=>{this.dispatch("ended");
this._id=null},1E3*a)}stop(){null!==this._id&&(c.clearTimeout(this._id),this.dispatch("stopped"),this._id=null)}}class p{constructor(a){a=a.innerHTML;a=a.replace(/\s{2,}/g,"");a=a.replace(/{{(.*?)}}/g,"',$1,'");a=a.split("{%").join("');");a=a.split("%}").join("a.push('");this.define("_source",new Function(`const a=[];a.push('${a}');return a.join('');`));this.define("_range",h.createRange())}render(a){return this._range.createContextualFragment(this._source.call(a))}}class q{constructor(a,b,d){const c=
/\((\/:[a-z]+)\)\?/g;c.test(a)&&(a=a.replace(c,"(?:$1)?"));this.define("handle",a);this.define("regExp",new RegExp(this.handle.replace(/:[a-z]+/g,"([a-zA-Z0-9\\-._~!$$&'()*,;=:@+%]+)")));this.define("callback",b);this.define("last",d||!1)}}class l extends Array{constructor(){super();c.addEventListener("hashchange",()=>this.match(),!1)}map(a,b,d){super.push(new q(a,b,d))}match(){const a=`/${m.hash.substr(3)}`;for(let b=0;b<this.length;b++){const d=this[b];let c=a.match(d.regExp);if(null!==c&&(c.shift(),
c=c.map(l.decode),console.info("Router: %s",d.handle,c),d.callback(...c),d.last))break}}static encode(a){return a.replace(/ /g,"+")}static decode(a){return c.decodeURIComponent(a.replace(/\+/g," "))}}class g extends e{get ready(){return this._ready}get timeout(){return this._xhr.timeout/1E3}set timeout(a){this._xhr.timeout=1E3*a}constructor(a,b){super();a=a||"json";b=b||"application/json";this.define("_targets",[]);this.define("_accept",b);this.define("_ready",!0,!0);this.define("_xhr",new XMLHttpRequest);
this._xhr.responseType=a;this._xhr.addEventListener("timeout",()=>{this._ready=!0;this._targets.forEach((a)=>a.removeAttribute("loading"));this.dispatch("timeout",this._targets)},!1);this._xhr.addEventListener("load",()=>{this._ready=!0;this._targets.forEach((a)=>a.removeAttribute("loading"));400>this._xhr.status?this.dispatch("loaded",this._xhr.response,this._targets):this.dispatch("error",this._xhr.response||{code:this._xhr.status,message:this._xhr.statusText},this._targets)},!1);this._xhr.addEventListener("error",
()=>{this._ready=!0;this._targets.forEach((a)=>a.removeAttribute("loading"));this.dispatch("error",{code:523,message:"Disconnected"},this._targets)},!1);this._xhr.addEventListener("progress",(a)=>{this.dispatch("progress",a.loaded,a.total)},!1)}request(a,b,c,e){c=c||null;e=e||null;console.info("Client: %s %s",a,b,c);this._targets.forEach((a)=>a.removeAttribute("loading"));this._targets.clear();this._xhr.abort();"GET"===a&&null!==c&&(b+=`?${g.query(c)}`);this._xhr.open(a,b,!0);this._xhr.setRequestHeader("Accept",
this._accept);"GET"!==a&&null!==c&&(c=JSON.stringify(c),this._xhr.setRequestHeader("Content-Type","application/json"));null!==e&&this._targets.push(...e);this._targets.forEach((a)=>a.addAttribute("loading"));this._xhr.send("GET"!==a?c:null);this._ready=!1}static encode(a){return c.encodeURIComponent(a)}static decode(a){return c.decodeURIComponent(a)}static query(a){return Object.keys(a).map((b)=>`${b}=${g.encode(a[b])}`).join("&")}}class r extends e{get open(){return this.element.hasAttribute("open")}set open(a){a?
this.element.addAttribute("open"):this.element.removeAttribute("open")}constructor(a){super();this.define("element",a)}show(){this.open=!0}close(){this.open=!1}}c.define("HB",{});c.HB.define("uuid",function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){let b=16*Math.random()|0;"y"===a&&(b=b&3|8);return b.toString(16)})});c.HB.define("Event",k);c.HB.define("EventTarget",e);c.HB.define("Timer",n);c.HB.define("Template",p);c.HB.define("Router",l);c.HB.define("Client",g);
c.HB.define("Showable",r)})(this);